# 需求分析：Watch List Alert (待观察账号/黑名单) 提醒系统

此系统用于监控特定的高风险、重点关注（VIP）或有异常行为历史的账号。每当这些账号有任何开仓动作时，风控系统将立即发出警报。

## 1. 具体方案

### 技术实现路径
通过监听交易服务器的实时通知事件来实现。

- **MT4 处理**: 监听 Manager API 的 `OnTradeUpdate` 事件。
- **MT5 处理**: 监听 `OnTransaction` 事件中的 `TRADE_TRANSACTION_ORDER_ADD`（挂单）或 `TRADE_TRANSACTION_DEAL_ADD`（成交开仓）。

### 核心逻辑
1.  **观察名单同步**: 系统维护一个 `Watch_List` 账户数据库或配置表。
2.  **事件过滤**:
    *   每当产生新交易，首先提取其 `Login` (账号 ID)。
    *   对比该 Login 是否存在于 `Watch_List` 中。
    *   检查交易性质，仅在“开仓”时触发报警（可配置是否包含平仓或挂单）。
3.  **实时通知**: 匹配成功后，系统提取该订单的详细信息（品种、方向、手数、入场价），并推送到风控中心。

---

## 2. 例子

**场景：重点监控套利可疑账户**
- **背景**: 账号 `123456` 因涉嫌违规套利被列入观察名单。
- **配置**: 开启 `Login: 123456` 的开仓实时预警。
- **动作**: 账号 `123456` 开仓卖出 0.1 手 `EURUSD`。
- **判定**: 系统检索到账号 `123456` 在 Watch List 中。
- **结果**: **立即发出警报**。
    *   **警报内容**: `[WatchList预警] 重点账户: 123456 | 行为: 新开仓 | 订单ID: 98765432 | 品种: EURUSD | 方向: SELL | 手数: 0.1 | 时间: 2025-12-25 17:23:32`

---

## 3. 配置参数

| 参数名称 | 类型 | 说明 | 示例值 |
| :--- | :--- | :--- | :--- |
| `Watched_Accounts` | Array | 监控的账号 ID 列表 | `[123456, 888888]` |
| `Monitoring_Actions` | Enum_Array | 需要触发报警的行为类型 | `["OPEN_TRADE", "PENDING_ORDER"]` |
| `Alert_Priority` | Enum | 警报级别（用于前端显示颜色区分） | `HIGH` (红色) / `INFO` (蓝色) |
| `Auto_Sync_Interval` | Integer | 名单同步间隔（如果名单存储在外部数据库） | `60` (秒) |
| `Comment_Keyword` | String | (可选) 仅监控带有特定订单注释的交易 | `EA_Trading` |
| `Lots_Min_Limit` | Float | (可选) 只有超过该手数的开仓才报警 | `0.01` (全量监控) |
