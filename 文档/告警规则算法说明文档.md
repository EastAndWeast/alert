# 交易风控管理系统 - 告警规则算法说明文档

本文档详细说明了系统中 10 种风控规则的**触发值算法**（触发告警时的数值来源）与**概要算法**（规则卡片上显示的配置摘要）。

---

## 1. Large Trade (手数) - `large_trade_lots`

*   **触发值算法**：
    *   **核心逻辑**：监控单笔开仓的手数是否超过设定阈值。
    *   **计算公式**：`触发值 = 当前订单手数`。
    *   **显示格式**：`[手数] Lots | [方向 (BUY/SELL)]`。
*   **概要算法**：
    *   展示内容：`手数阈值`、`监控品种`（若为空则显示“全部”）。

## 2. Large Trader (USD) - `large_trade_usd`

*   **触发值算法**：
    *   **核心逻辑**：计算单笔订单的合约价值（折合美元）是否超过阈值。
    *   **计算公式**：`触发值 = 手数 * 合约大小 * 当前市价`。
    *   **显示格式**：`$[美元价值] | [手数] Lots`。
*   **概要算法**：
    *   展示内容：`美元价值阈值`、`分公司组/特殊账户组`、`监控品种`。

## 3. Liquidity Trade (流动性/分批建仓) - `liquidity_trade`

*   **触发值算法**：
    *   **核心逻辑**：在指定时间窗口内，同一方向的订单累计手数或订单数超过阈值。
    *   **计算公式**：`触发值 = 窗口时间内累计手数`。
    *   **显示格式**：`[累计手数] Lots | [订单数] 笔 | [方向]`。
*   **概要算法**：
    *   展示内容：`时间窗口`、`最小订单数`、`总手数阈值`、`监控范围`。

## 4. Scalping (刷单/剥头皮) - `scalping`

*   **触发值算法**：
    *   **核心逻辑**：监控持仓时间极短且盈利超过一定金额的快速交易。
    *   **计算公式**：`触发值 = 持仓时间 (平仓时间 - 开仓时间)`。
    *   **显示格式**：`[持仓秒数]s | [手数] Lots | [盈亏额]`。
*   **概要算法**：
    *   展示内容：`持仓时间阈值`、`最小盈利阈值`、`监控品种`。

## 5. Exposure Alert (敞口告警) - `exposure_alert`

*   **触发值算法**：
    *   **核心逻辑**：监控特定货币或品种的净头寸价值是否超过风控额度。
    *   **计算公式**：`触发值 = SUM(买入手数 * 合约大小) - SUM(卖出手数 * 合约大小)`（取绝对值）。
    *   **显示格式**：`$[美元净敞口] | [方向] [货币/品种]`。
*   **概要算法**：
    *   展示内容：`目标货币`、`敞口阈值`、`刷新间隔`。

## 6. Pricing & Volatility (行情异常/波动) - `pricing_volatility`

*   **触发值算法**：
    *   **核心逻辑**：监控报价停止时间或瞬时价格变动幅度。
    *   **计算公式**：
        *   停价：`触发值 = 未收到报价的持续秒数`。
        *   波动：`触发值 = 当前价格 - 上一价格`（或百分比）。
    *   **显示格式**：
        *   停价：`[秒数]s | 停价`
        *   波动：`[变动点数] 点 | 剧烈波动`
*   **概要算法**：
    *   展示内容：`停价检查时长`、`波动模式 (点数/百分比)`、`阈值`、`监控范围`。

## 7. NOP Limit (净敞口限额) - `nop_limit`

*   **触发值算法**：
    *   **核心逻辑**：类似 Exposure 但侧重于整站或多账户的净头寸限额，通常带杠杆系数计算。
    *   **计算公式**：`触发值 = 净敞口折合美元价值`。
    *   **显示格式**：`[净手数] Lots | [净方向] | $[美元价值]`。
*   **概要算法**：
    *   展示内容：`平台/系数`、`NOP 限额阈值`、`监控品种`、`计算频率`。

## 8. Watch List (重点监控清单) - `watch_list`

*   **触发值算法**：
    *   **核心逻辑**：对特定账户的所有动作（开仓、挂单）进行实时追踪。
    *   **计算公式**：`触发值 = 当前触发动作的订单手数`。
    *   **显示格式**：`[手数] Lots | [方向] | [动作 (开仓/挂单)]`。
*   **概要算法**：
    *   展示内容：`监控账号列表`、`监控动作类型`、`最小手数过滤`。

## 9. Reverse Positions (反手操作) - `reverse_positions`

*   **触发值算法**：
    *   **核心逻辑**：监控在极短时间内平掉原仓位并反向开仓的行为。
    *   **计算公式**：`触发值 = 时间间隔 (新单开仓时间 - 旧单平仓时间)`。
    *   **显示格式**：`[间隔秒数]s | [原方向]→[新方向] | [原手数]→[新手数] Lots`。
*   **概要算法**：
    *   展示内容：`最大反手间隔`、`最小反向手数`、`最小美元价值`。

## 10. Deposit & Withdrawal (大额出入金) - `deposit_withdrawal`

*   **触发值算法**：
    *   **核心逻辑**：监控账户的单笔入金或出金金额是否超过阈值。
    *   **计算公式**：`触发值 = 交易金额`。
    *   **显示格式**：`$[金额] | [类型 (入金/出金)]`。
*   **概要算法**：
    *   展示内容：`入金阈值`、`出金阈值`、`关键字过滤 (包含/排除)`。

---
*文档生成于：2026-02-09*
