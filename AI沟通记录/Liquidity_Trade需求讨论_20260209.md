# Liquidity Trade 需求讨论记录

**时间**: 2026-02-09 11:03  
**主题**: Liquidity Trade 功能需求分析

---

## USER 输入

用户提出了 Liquidity Trade 的需求，具体内容包括：

### 客户原始需求
1. **核心功能**: 检测客户短时间内开多张订单（每张小手数，总计超过10手），判定为消耗市场深度行为，需发出警报

2. **算法参数**:
   - 时间间隔: 60秒
   - 订单数量: ≥2 张（相同方向、相同产品）
   - 产品范围: 支持具体产品(如 XAUUSD)或产品分类(如 Metals, Forex)

3. **产品分类映射**: 需要建立产品大类mapping，因不同平台产品名称不同

4. **客户选择机制**: 可选择具体产品或产品大类

### 关注点
1. 是否可以满足客户需求？
2. 是否存在过度设计？

---

## ASSISTANT 分析

### 结论概要
- ✅ **完全可以满足客户需求**
- ❌ **无过度设计**，所有功能点均为必要

### 核心分析要点

#### 1. 功能可行性
所有需求点均可通过以下方式实现：
- 时间窗口监控（滑动窗口）
- 订单聚合统计（按产品+方向分组）
- 产品分类映射表
- 灵活的过滤机制

#### 2. 设计合理性评估
所有提出的功能点均属必要：
- 时间窗口配置 → 适应不同风控标准
- 产品分类映射 → 解决多平台命名差异
- 产品大类选择 → 提升配置效率
- 方向过滤 → 符合业务逻辑

#### 3. 需要补充确认的问题
1. 手数阈值10手是否改为可配置？（建议：是）
2. 时间窗口使用滑动窗口还是固定窗口？（建议：滑动窗口）
3. 订单数量比较符用 `>=` 还是 `>`？（建议：客户可选）
4. 是否需要账户白名单/黑名单？（建议：考虑增加）

### 设计建议

#### 数据模型
- `liquidity_trade_rules` 表：存储规则配置
- `symbol_classifications` 表：产品分类映射

#### UI设计
- 规则配置页面：参数化配置
- 产品分类管理页面：映射关系维护

#### 检测算法
滑动窗口 + 订单聚合统计 + 阈值判断

---

## 待用户确认事项

> [!IMPORTANT]
> 请确认以下问题：

1. **手数阈值可配置化**：是否同意将10手改为可配置参数？
2. **时间窗口类型**：采用滑动窗口（推荐）还是固定窗口？
3. **订单数量比较**：使用 `>=` 还是 `>` 或提供选择？
4. **账户过滤**：是否需要白名单/黑名单机制？

---

## 下一步行动

待用户确认上述问题后：
1. 确定最终的数据库Schema
2. 设计并实现产品分类管理UI
3. 实现检测算法核心逻辑
4. 集成警报通道
5. 编写测试用例

---

**状态**: 等待用户确认补充问题
