# 告警详情字段规则分析报告

## 概要
在告警记录列表中，“详情”列（Details）的显示内容是根据告警的**规则类型（rule_type）**动态生成的。具体逻辑实现在前端 `js/modules/alerts.js` 文件的 `formatDetails(alert)` 函数中。

## 详细渲染逻辑
系统根据告警所属的不同规则类型，从告警数据的 `details` 对象中提取关键字段进行展示：

| 规则类型 | 展示内容示例 | 逻辑说明 |
| :--- | :--- | :--- |
| **Large Trade (手数)** | `BUY` / `SELL` | 展示交易方向 (`details.direction`) |
| **Large Trade (USD)** | `2.5 手 USD` | 展示成交手数及账户币种 (`details.lots`, `details.account_currency`) |
| **Liquidity Trade** | `8 笔 BUY` | 展示在时间窗口内的成交订单数及方向 (`details.order_count`, `details.direction`) |
| **Scalping (刷单)** | `最小盈利: $850` | 展示该笔短线交易的盈利金额 (`details.profit_usd`) |
| **Exposure Alert (敞口)** | `USD LONG` | 展示达到阈值的货币及其头寸方向 (`details.currency`, `details.direction`) |
| **Reverse Positions (反向开仓)** | `BUY→SELL` | 展示平仓方向及随后立即反向开仓的方向 (`details.close_direction`, `details.open_direction`) |
| **Deposit & Withdrawal (出入金)** | `DEPOSIT` / `WITHDRAWAL` | 展示操作类型 (`details.type`) |
| **Pricing & Volatility (行情)** | `PRICING` / `VOLATILITY` | 展示告警的具体子类型 (`details.alert_subtype`) |
| **NOP Limit (净头寸限额)** | `LONG 62 手` | 展示净头寸方向及手数 (`details.direction`, `details.net_position`) |
| **Watch List (观察名单)** | `OPEN_TRADE BUY` | 展示触发的行为及方向 (`details.action`, `details.direction`) |

## 源码参考
> [!NOTE]
> 核心逻辑位于 [alerts.js:202-218](file:///Users/wyy/Desktop/%E5%B7%A5%E4%BD%9C/HexPay/3.AI/Google%20antigravity/18.Alert%E9%A1%B9%E7%9B%AE%E9%9C%80%E6%B1%82%E5%88%86%E6%9E%90/trading-risk-admin/js/modules/alerts.js#L202-L218)

```javascript
    formatDetails(alert) {
        var d = alert.details;
        if (!d) return '-';

        var t = alert.rule_type;
        if (t === 'large_trade_lots') return d.direction;
        if (t === 'large_trade_usd') return d.lots + ' ' + I18n.t('unit_lots') + ' ' + d.account_currency;
        // ... 其他类型判断
        return '-';
    },
```

## 结论
“详情”字段并非单一的静态值，而是**对触发告警的核心参数进行的简要摘要**。如果需要查看更完整的信息，可以点击该行末尾的“详情”按钮，系统会加载完整的弹窗，其中包含更详细的规则设置和关联交易信息。
