# Exposure Alert 需求讨论

**时间**: 2026-02-09 13:44  
**讨论主题**: Exposure Alert (敞口监控) 需求分析

---

## 📋 用户需求

### 原始需求
1. **敞口监控**: 设定某个currency的exposure超过所设定的参数，进行警报（需要进行计算）
2. **算法来源**: 
   - 由客户方提供算法
   - 需要`mt5_symbols` & `mt5_prices` 的API进行计算
   - 或由我方根据客户算法思路实现

### 配置需求
- 时间次数
- 提醒次数 (频率=次)

### 关注点
1. 是否可以满足客户的需求
2. 是否过度设计：设计了不需要的内容

---

## 🔍 AI分析结果

### ✅ 配置层面 - 完全满足

**现有配置参数**:
```javascript
{
  target_currency: 'USD',           // ✅ 目标货币
  exposure_threshold: 10000000,     // ✅ 敞口阈值
  time_interval: 600,               // ✅ 时间间隔
  max_remind_count: 1,              // ✅ 提醒次数
  calculation_mode: 'ONLY_POSITIONS' // ❓ 是否需要?
}
```

**结论**: 配置参数**完全覆盖**客户需求!

### ⚠️ 计算层面 - 需要补充

**缺少的部分**:
1. ❌ 敞口计算的具体实现代码
2. ❌ mt5_symbols & mt5_prices API集成
3. ❌ 算法文档和示例

---

## ❓ 关键待确认问题

### 🔴 高优先级 - 必须确认

#### 1. 敞口计算算法是什么？

**需要了解**:
- 计算公式是什么？
- 输入数据有哪些字段？
- 输出结果(净敞口值)如何计算？
- 方向(LONG/SHORT)如何判定？

**示例格式**:
```
Exposure(USD) = Σ(每个交易对的USD敞口)
              = EURUSD的敞口 + USDJPY的敞口 + ...
```

#### 2. mt5_symbols & mt5_prices API 是什么？

**需要了解**:
- API接口地址是什么？
- 返回数据格式？
- 示例数据？
- 调用频率限制？

**示例数据请求**:
```json
// mt5_symbols 返回什么?
{
  "symbols": [
    {"symbol": "EURUSD", "base": "EUR", "quote": "USD", ...},
    {"symbol": "USDJPY", "base": "USD", "quote": "JPY", ...}
  ]
}

// mt5_prices 返回什么?
{
  "prices": [
    {"symbol": "EURUSD", "bid": 1.0850, "ask": 1.0851, ...}
  ]
}
```

#### 3. 计算在哪里进行？

**选项**:
- **A. 后端计算** (推荐) - 实时性好,数据准确
- **B. 前端计算** - 可行,但依赖API
- **C. 客户方计算** - 系统只做展示

您期望哪种方式?

### 🟡 中优先级 - 建议确认

#### 4. calculation_mode 是否需要？

**当前设计**:
- `ONLY_POSITIONS`: 仅计算当前持仓
- `WITH_PENDING`: 包含挂单

**问题**: 客户是否需要这个区分功能?

#### 5. 频率控制的准确含义？

**当前理解**:
- `time_interval: 600` - 每600秒检查一次
- `max_remind_count: 1` - 最多提醒1次

**问题**: 这样理解是否正确?

---

## 📊 系统现状

### 已有功能
✅ 完善的配置界面  
✅ 清晰的数据结构  
✅ 触发值显示: `$12,500,000 | LONG USD`

### 缺少功能
❌ 敞口计算引擎  
❌ mt5 API集成  
❌ 算法文档

---

## 🎯 建议的后续步骤

### Step 1: 获取算法信息 ⭐
请客户提供:
1. 敞口计算的详细算法(公式)
2. mt5 API的具体说明和示例
3. 算法在哪里执行的期望

### Step 2: 确认配置需求
1. calculation_mode是否需要?
2. 频率控制逻辑确认

### Step 3: 设计实施方案
1. 根据算法设计计算模块
2. 设计API集成方案
3. 编写实施文档

---

**当前状态**: ⏸️ 等待客户提供算法和API详细信息

**相关文档**: `文档/Exposure_Alert需求分析.md`
